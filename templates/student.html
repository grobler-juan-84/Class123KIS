{% extends 'base.html' %}

{% block title %}{{ student.name }} - ClassDojo Clone{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Student Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Dashboard</a></li>
                                    <li class="breadcrumb-item"><a href="{{ url_for('class_view', class_id=class_info.id) }}">{{ class_info.name }}</a></li>
                                    <li class="breadcrumb-item active">{{ student.name }}</li>
                                </ol>
                            </nav>
                            <div class="d-flex align-items-center">
                                <div class="student-avatar me-4">{{ student.avatar }}</div>
                                <div>
                                    <h1 class="mb-2">{{ student.name }}</h1>
                                    <p class="text-muted mb-0">{{ class_info.name }} â€¢ Taught by {{ teacher.name }}</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="d-flex gap-2 justify-content-end">
                                <button class="btn btn-primary" onclick="awardPoints({{ student.id }})">
                                    <i class="fas fa-star me-1"></i>Award Points
                                </button>
                                <button class="btn btn-outline-primary">
                                    <i class="fas fa-cog"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Student Stats -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="stat-number text-primary">{{ student.points }}</div>
                    <div class="stat-label">Total Points</div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="stat-number text-success">{{ (student.points // 10) + 1 }}</div>
                    <div class="stat-label">Level</div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="stat-number text-warning">12</div>
                    <div class="stat-label">Skills Practiced</div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center">
                <div class="card-body">
                    <div class="stat-number text-info">95%</div>
                    <div class="stat-label">Engagement</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Skills Progress -->
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-trophy me-2"></i>Skills Progress</h5>
                </div>
                <div class="card-body">
                    {% for skill in skills %}
                    <div class="mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <div class="d-flex align-items-center">
                                <span class="me-2">{{ skill.icon }}</span>
                                <span class="fw-bold">{{ skill.name }}</span>
                            </div>
                            <span class="badge bg-{{ skill.color }}">{{ (student.points // skills|length) + (loop.index * 2) }} pts</span>
                        </div>
                        <div class="progress" style="height: 8px;">
                            <div class="progress-bar bg-{{ skill.color }}" role="progressbar" 
                                 style="width: {{ ((student.points // skills|length) + (loop.index * 2)) % 100 }}%"></div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="col-lg-6">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-clock me-2"></i>Recent Activity</h5>
                </div>
                <div class="card-body">
                    <div class="activity-item">
                        <div class="d-flex align-items-start">
                            <div class="me-3">
                                <div class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                    <i class="fas fa-star"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-bold">Earned 5 points</div>
                                <div class="text-muted small">For showing great teamwork in group project</div>
                                <div class="activity-time">2 hours ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="d-flex align-items-start">
                            <div class="me-3">
                                <div class="bg-warning text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                    <i class="fas fa-palette"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-bold">Earned 3 points</div>
                                <div class="text-muted small">For creative artwork in art class</div>
                                <div class="activity-time">1 day ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="d-flex align-items-start">
                            <div class="me-3">
                                <div class="bg-info text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                    <i class="fas fa-dumbbell"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-bold">Earned 4 points</div>
                                <div class="text-muted small">For perseverance in math homework</div>
                                <div class="activity-time">2 days ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-item">
                        <div class="d-flex align-items-start">
                            <div class="me-3">
                                <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                    <i class="fas fa-question-circle"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-bold">Earned 2 points</div>
                                <div class="text-muted small">For asking thoughtful questions</div>
                                <div class="activity-time">3 days ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-3">
                        <a href="#" class="btn btn-outline-primary btn-sm">View All Activity</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Achievements -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-medal me-2"></i>Achievements</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-2 col-sm-4 col-6 mb-3">
                            <div class="text-center">
                                <div class="achievement-badge bg-warning text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 60px; height: 60px;">
                                    <i class="fas fa-star fa-lg"></i>
                                </div>
                                <div class="small fw-bold">First Points</div>
                                <div class="small text-muted">Earned first points</div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-6 mb-3">
                            <div class="text-center">
                                <div class="achievement-badge bg-success text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 60px; height: 60px;">
                                    <i class="fas fa-users fa-lg"></i>
                                </div>
                                <div class="small fw-bold">Team Player</div>
                                <div class="small text-muted">Great teamwork</div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-6 mb-3">
                            <div class="text-center">
                                <div class="achievement-badge bg-info text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 60px; height: 60px;">
                                    <i class="fas fa-palette fa-lg"></i>
                                </div>
                                <div class="small fw-bold">Artist</div>
                                <div class="small text-muted">Creative work</div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-6 mb-3">
                            <div class="text-center">
                                <div class="achievement-badge bg-secondary text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 60px; height: 60px;">
                                    <i class="fas fa-lock fa-lg"></i>
                                </div>
                                <div class="small fw-bold">Mystery Badge</div>
                                <div class="small text-muted">Keep working!</div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-6 mb-3">
                            <div class="text-center">
                                <div class="achievement-badge bg-secondary text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 60px; height: 60px;">
                                    <i class="fas fa-lock fa-lg"></i>
                                </div>
                                <div class="small fw-bold">Mystery Badge</div>
                                <div class="small text-muted">Keep working!</div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-4 col-6 mb-3">
                            <div class="text-center">
                                <div class="achievement-badge bg-secondary text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 60px; height: 60px;">
                                    <i class="fas fa-lock fa-lg"></i>
                                </div>
                                <div class="small fw-bold">Mystery Badge</div>
                                <div class="small text-muted">Keep working!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Award Points Modal -->
<div class="modal fade" id="awardPointsModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Award Points to {{ student.name }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="POST" action="{{ url_for('award_points') }}">
                <div class="modal-body">
                    <input type="hidden" name="student_id" value="{{ student.id }}">
                    
                    <div class="mb-3">
                        <label class="form-label">Skill</label>
                        <select name="skill_id" class="form-select" required>
                            {% for skill in skills %}
                            <option value="{{ skill.id }}">{{ skill.icon }} {{ skill.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Points</label>
                        <select name="points" class="form-select" required>
                            <option value="1">1 point</option>
                            <option value="2">2 points</option>
                            <option value="3">3 points</option>
                            <option value="5">5 points</option>
                            <option value="10">10 points</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Reason (optional)</label>
                        <textarea name="reason" class="form-control" rows="3" placeholder="Why are you awarding these points?"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary">Award Points</button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
function awardPoints(studentId) {
    new bootstrap.Modal(document.getElementById('awardPointsModal')).show();
}
</script>
{% endblock %}
